# commit_pod 要件定義書（現状実装ベース）

## アプリ情報
- 名称: COMMIT POT
- 目的プラットフォーム: モバイル/WEB（React Native + Expo）
- データ基盤: Supabase（Auth + DB）
- 主題: 筋トレ向け「鍋」中心の自炊支援アプリ

## 背景・目的
- 筋トレ初心者が「栄養バランスの良い自炊」を継続しやすくする。
- 身体情報から1日の目標摂取PFC/カロリーを計算し、鍋1食分の分量・食材選定・仕込み手順まで一気通貫で支援する。

## スコープ
- 含む: オンボーディング（身体情報）、プラン作成（鍋）、買い物リスト、仕込み（調理）ガイド、ストック管理、食材図鑑、認証/保存
- 含まない（現状）: 鍋以外の料理提案、AI栄養士、外部連携（ヘルスケア連携等）

## 想定ユーザー・ユースケース
- 想定ユーザー: 20〜30代男性の筋トレ初心者
- 主なユースケース
  - 初回に身体情報を入力して目標摂取量を把握
  - 鍋プラン（食数/ベース/食材）を作成
  - 買い物リストを確認して購入
  - 仕込みモードで調理
  - ストックの残数を管理し、食べたら減らす

## 画面要件
- Splash
  - ロゴ/アプリ名表示（2秒後オンボーディングへ）
- Auth
  - サインイン/サインアップ
  - Supabase Authでメール/パスワード
- Onboarding（2ステップ）
  - Step1: 身長/体重/年齢/性別
  - Step2: 活動量/目的/結果表示（TDEE/目標カロリー/PFC）
- Dashboard
  - 新規鍋作成導線
  - 食材図鑑への導線
  - 鍋ストック一覧（残食数、作成日）
  - 「食べた！」で残数減少
- Builder（プラン作成: 6ステップ）
  1. 食数選択（2 or 5）
  2. 鍋ベース選択（寄せ/味噌/キムチ）
  3. タンパク質2種選択
  4. 野菜2種＋きのこ1種選択
  5. 炭水化物1種選択
  6. 食材量/調味料/1食理想値/実績値表示、確定
- Shopping
  - 食材カテゴリ別リスト（タンパク/野菜/炭水化物/調味料）
  - 仕込みモード開始
- Cook
  - 7ステップの仕込みガイド（写真/説明/コツ）
- Cards
  - 食材図鑑（食材効果、栄養成分）

## 機能要件
- 身体情報入力・保存
- 目標摂取量（PFC/カロリー）の自動計算
- 鍋プランの作成/保存/削除
- 食材量の自動算出
- 1食分の理想値/実績値の表示
- 買い物リストの生成
- 仕込みガイドの表示
- ストック管理（残食数）
- 食材図鑑
- 認証（メール/パスワード）

## 計算仕様
- BMR（Mifflin-St Jeor）
  - 男性: 10*体重 + 6.25*身長 - 5*年齢 + 5
  - 女性: 10*体重 + 6.25*身長 - 5*年齢 - 161
- TDEE
  - 活動量係数: low=1.2 / normal=1.55 / high=1.725
- 目標カロリー
  - 目的係数: bulk=1.1 / recomp=1.0 / cut=0.88
- PFC
  - タンパク質: 体重×(bulk=2.2, その他=2.3)
  - 脂質: 体重×(bulk=0.95, recomp=1.8, cut=2.0)
  - 最低脂質60g、最低炭水化物50gを担保
- 1食分の理想値
  - 1食 = 1日の10分の3（0.3）
- 鍋食材量
  - 食数に応じて目標P/C/野菜量を配分
  - タンパク質は2種で均等配分
  - 野菜は2種+きのこ1種で均等配分
  - 炭水化物は1種

## データ要件
- マスタデータ
  - 食材（栄養素、効果、写真、単位重量等）
  - 鍋ベース（寄せ/味噌/キムチ）
  - ベースごとの調味料量（食数別）
- ユーザーデータ
  - 身体情報（身長/体重/年齢/性別/活動量/目的）
  - 計算結果（BMR/TDEE/目標カロリー/目標PFC）
  - 鍋プラン（食数、残食数、ベース、食材ID群、作成日時、PFC）
- ローカル保存
  - モーダル非表示フラグ（5食注意/プラン確定/買い物導入）

## API要件（Supabase）
- Auth
  - signInWithPassword / signUp / signOut
- profiles テーブル
  - user_id (PK/FK)
  - height, weight, age, gender, activity_level, goal
  - bmr, tdee, target_calories, target_pfc
- plans テーブル
  - id (PK)
  - user_id (FK)
  - servings, remaining, pot_base, proteins[], veggies[], carb
  - created_at, target_pfc

## 技術要件
- フロント: React Native + Expo
- 状態管理: React Hooks（useState/useEffect/useMemo）
- データ保存: Supabase (Auth + DB)
- ローカルストレージ: AsyncStorage
- 画像: ローカルアセット
- Web対応: Platform.OS === 'web' での確認ダイアログ切替

